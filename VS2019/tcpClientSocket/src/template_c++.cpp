#include <iostream>
#include <co/all.h>
#include "CTcpClient.h"

CTcpClient *tcpClient = new CTcpClient("127.0.0.1", 6666);
const char *str_ = "{	\"groupName\":	\"QBB\",	\"data\":	[{			\"tag\":	\"IB103_K_CNT5\",			\"value\":	\"\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB103_K_COLOR1\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB103_K_COLOR2\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB103_K_COLOR3\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB103_K_COLOR4\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB103_K_COLOR5\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB103_K_DELAY1\",			\"value\":	\"5000.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB103_K_DELAY2\",			\"value\":	\"5000.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB103_K_DELAY3\",			\"value\":	\"5000.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB103_K_DELAY4\",			\"value\":	\"5000.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB103_K_DELAY5\",			\"value\":	\"5000.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB103_K_FONT1\",			\"value\":	\"115.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB103_K_FONT2\",			\"value\":	\"115.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB103_K_FONT3\",			\"value\":	\"115.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB103_K_FONT4\",			\"value\":	\"115.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB103_K_FONT5\",			\"value\":	\"115.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB103_K_WAY1\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB103_K_WAY2\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB103_K_WAY3\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB103_K_WAY4\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB103_K_WAY5\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB104_KX_CNT\",			\"value\":	\"严禁变道变道抓拍\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB104_K_CNT1\",			\"value\":	\"严禁变道变道抓拍\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB104_K_CNT2\",			\"value\":	\"\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB104_K_CNT3\",			\"value\":	\"\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB104_K_CNT4\",			\"value\":	\"\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB104_K_CNT5\",			\"value\":	\"\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB104_K_COLOR1\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB104_K_COLOR2\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB104_K_COLOR3\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB104_K_COLOR4\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB104_K_COLOR5\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB104_K_DELAY1\",			\"value\":	\"5.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB104_K_DELAY2\",			\"value\":	\"5000.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB104_K_DELAY3\",			\"value\":	\"5000.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB104_K_DELAY4\",			\"value\":	\"5000.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB104_K_DELAY5\",			\"value\":	\"5000.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB104_K_FONT1\",			\"value\":	\"115.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB104_K_FONT2\",			\"value\":	\"115.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB104_K_FONT3\",			\"value\":	\"115.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB104_K_FONT4\",			\"value\":	\"115.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB104_K_FONT5\",			\"value\":	\"115.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB104_K_WAY1\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB104_K_WAY2\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB104_K_WAY3\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB104_K_WAY4\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB104_K_WAY5\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB105_KX_CNT\",			\"value\":	\"严禁变道变道抓拍\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB105_K_CNT1\",			\"value\":	\"\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB105_K_CNT2\",			\"value\":	\"\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB105_K_CNT3\",			\"value\":	\"\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB105_K_CNT4\",			\"value\":	\"\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB105_K_CNT5\",			\"value\":	\"\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB105_K_COLOR1\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB105_K_COLOR2\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB105_K_COLOR3\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB105_K_COLOR4\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB105_K_COLOR5\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB105_K_DELAY1\",			\"value\":	\"5000.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB105_K_DELAY2\",			\"value\":	\"5000.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB105_K_DELAY3\",			\"value\":	\"5000.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB105_K_DELAY4\",			\"value\":	\"5000.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB105_K_DELAY5\",			\"value\":	\"5000.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB105_K_FONT1\",			\"value\":	\"115.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB105_K_FONT2\",			\"value\":	\"115.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB105_K_FONT3\",			\"value\":	\"115.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB105_K_FONT4\",			\"value\":	\"115.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB105_K_FONT5\",			\"value\":	\"115.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB105_K_WAY1\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB105_K_WAY2\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB105_K_WAY3\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB105_K_WAY4\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB105_K_WAY5\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB106_KX_CNT\",			\"value\":	\"全程监控严禁超速\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB106_K_CNT1\",			\"value\":	\"\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB106_K_CNT2\",			\"value\":	\"\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB106_K_CNT3\",			\"value\":	\"\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB106_K_CNT4\",			\"value\":	\"\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB106_K_CNT5\",			\"value\":	\"\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB106_K_COLOR1\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB106_K_COLOR2\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB106_K_COLOR3\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB106_K_COLOR4\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB106_K_COLOR5\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB106_K_DELAY1\",			\"value\":	\"5000.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB106_K_DELAY2\",			\"value\":	\"5000.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB106_K_DELAY3\",			\"value\":	\"5000.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB106_K_DELAY4\",			\"value\":	\"5000.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB106_K_DELAY5\",			\"value\":	\"5000.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB106_K_FONT1\",			\"value\":	\"115.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB106_K_FONT2\",			\"value\":	\"115.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB106_K_FONT3\",			\"value\":	\"115.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB106_K_FONT4\",			\"value\":	\"115.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB106_K_FONT5\",			\"value\":	\"115.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB106_K_WAY1\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB106_K_WAY2\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB106_K_WAY3\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB106_K_WAY4\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB106_K_WAY5\",			\"value\":	\"1.000000\",			\"time\":	\"1680617552\"		},{			\"tag\":	\"IB107_KX_CNT\",			\"value\":	\"全程监控严禁超速\",			\"time\":	\"1680617552\"		}]}";

int64 time_start = 0;
int64 time_end = 0;

int main()
{
    while (1)
    {
        if (!tcpClient)
        {
            tcpClient = new CTcpClient("127.0.0.1", 6666);
            tcpClient->Connect();
            std::cout << "delete tcpClient!\n";
        }
        if (tcpClient->Connected())
        {
            if (tcpClient->SendMsg(str_))
            {
                std::cout << "Hello World!\n";
            }
        }
        else
        {
            
            time_start = epoch::ms();
            tcpClient->Connect();
            std::cout << "耗时： " << epoch::ms() - time_start << "\n";
            std::cout << "tcpClient->reConnect\n";
        }

        co::sleep(1000);
    }
}
